<script>
  window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
      t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);

    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };

    return t;
  }(document, "script", "twitter-wjs"));
</script>

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8">
</script>

<%# TIMELINE SCROLLER %>
<div data-controller="timescroll">
  <div class="w-100 px-4" data-action="change->timescroll#select" >
    <%= render "timescroll", stock: @stock %>
  </div>

  <%# ADD STOCK TO PORTFOLIO BUTTON %>
  <div class="fixed top-1/2 -mr-9 hover:-mr-3 ease-in-out duration-100 z-50 right-0 px-3 py-3 lg:px-5 lg:pl-3">
    <%= render "add", stock: @stock %>
  </div>

  <%# CONTAINER TO HOUSE ALL STOCK INFO %>
    <div class="h-152 w-full relative overflow-y-auto">

        <div class="w-full h-full grid grid-rows-6 grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-3">

          <%# STOCK INFO %>
          <div id="stock-info" class="row-span-2 bg-white p-1 sm:p-2 xl:p-4">
            <div class="flex items-center justify-between mb-4">
              <%= render "price_widget", stock: @stock %>
            </div>
            <div id="basic-info", class="flex items-center justify-between mb-4">
              <%# <%= render "basic_info", stock: @stock %> %>
            </div>
          </div>

          <%# TWITTER %>
          <div id="twitter" class="row-span-6 h-full bg-white shadow rounded-lg p-4 sm:p-4 xl:p-6 overflow-y-auto">
            <div class="flex-shrink-0 w-full">
              <%# tweets here %>
              <%= turbo_frame_tag dom_id(@stock, :tweets), src: stock_tweets_path(@stock) do %>
              <% end %>
            </div>
          </div>

          <%# PRICE CHART %>
          <div id="price-chart" class="row-span-3 bg-white shadow rounded-lg mb-4 p-4 sm:p-6 h-full">
              <div class="flex items-center justify-between mb-4 h-full">
                <%= render "price_chart", stock:@stock %>
              </div>
          </div>

          <%# REDDIT %>
          <div id="reddit" class="row-span-4 bg-white shadow rounded-lg p-4 sm:p-6 xl:p-8 overflow-y-auto overflow-y-auto">
            <%= render "stocks/reddit-section", reddit_articles: @reddit_articles %>
          </div>

          <%# NEWS %>
          <div id="news" class="row-span-3 bg-white shadow rounded-lg mb-4 p-4 sm:p-6 h-full overflow-y-auto overflow-y-auto">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-xl font-bold leading-none text-gray-900">Latest News Here</h3>
            </div>

            <div data-timescroll-target="news">
              <%= render "news", stock: @stock, enddate: @enddate %>
            </div>

            <p data-timescroll-target="tickername" class="hidden"><%= @stock.ticker %></p>

          </div>
        </div>

    </div>

  </div>
</div>
